'use strict';(function(l,G,u,n,m,c){m(function(){var a=u.createElement,f=u.createClass,d=u.PropTypes,h=c.map,H=m("#meta-user").attr("value"),r=m("#meta-priv").attr("value"),z=function(a){var e=("https:"===l.location.protocol?"wss://":"ws://")+l.location.host+a,g=null,c=null,k=null,d=function(){2E3<Date.now()-k?(k=Date.now(),g=new l.WebSocket(e),g.onmessage=c,g.onerror=function(){console.log("APIConnectionWS: conn.onerror");d()},g.onclose=function(a){console.log("APIConnectionWS: conn.onclose");console.log(a);
d()}):l.setTimeout(d,Date.now()-k)};return{registerCallback:function(a){g||d();var b=function(b){return a(JSON.parse(b.data))};c=g.onmessage=b},pathname:function(){return a},close:function(){g.onmessage=function(){};g.onerror=function(){};g.onclose=function(){};c=null;g.close()}}},A=function(a){var e="//"+l.location.host+a,g=null,c=null,k=function(){g=new l.EventSource(e);g.onmessage=c;g.onerror=function(){console.log("APIConnectionSSE: conn.onerror")};g.onclose=function(){console.log("APIConnectionSSE: conn.onclose")}};
return{registerCallback:function(a){g||k();var b=function(b){return a(JSON.parse(b.data))};c=g.onmessage=b},pathname:function(){return a},close:function(){c=null;g.close()}}},B=function(a){var e="//"+l.location.host+a,g=null,c=null,k=function(){m.ajax({url:e,success:function(a){g&&g(a);c=l.setTimeout(k,3E3)}})};k();return{registerCallback:function(a){g=a},pathname:function(){return a},close:function(){c&&l.clearTimeout(c);c=null}}},t=l.EventSource?A:l.WebSocket?z:B,E=f(c.defaults({propTypes:{firstRowSpan:d.number.isRequired,
entity:d.object.isRequired,entityEditor:d.any.isRequired,auxiliary:d.object},render:function(){var b=this,e=p[l.location.pathname].dataSpec,g=null!==e.categoryColumn&&b.props.firstRowSpan?a("td",{rowSpan:b.props.firstRowSpan},e.categoryColumn[1].apply(b.props.auxiliary,[b.props.entity[e.categoryColumn[0]],b.props.entity])):null,c=function(){return n.render(a(b.props.entityEditor,{auxiliary:b.props.auxiliary,entity:b.props.entity}),q())},k=function(){return n.render(a(J,{auxiliary:b.props.auxiliary,
entity:b.props.entity}),q())};return a("tr",{},g,h(e.columns,function(e,c){return a("td",{key:c},e[1].apply(b.props.auxiliary,[b.props.entity[e[0]],b.props.entity]))}),"PrivAdmin"===r?a("td",{className:"text-right"},a("div",{className:"btn-group",role:"group"},a("button",{type:"button",className:"btn btn-default btn-xs",title:"Edit",onClick:c},a("span",{className:"glyphicon glyphicon-pencil","aria-hidden":"true"})),a("button",{type:"button",className:"btn btn-default btn-xs",title:"Delete",onClick:k},
a("span",{className:"glyphicon glyphicon-trash","aria-hidden":"true"})))):null)}},{render:function(){return!1}},c.invert({EntityRow:"displayName"}))),K=f(c.defaults({propTypes:{entities:d.array.isRequired,entityEditor:d.any.isRequired,auxiliary:d.object},render:function(){var b=this;return a("tbody",{},h(this.props.entities,function(e,c,d){return a(E,{key:e.id,entityEditor:b.props.entityEditor,auxiliary:b.props.auxiliary,entity:e,firstRowSpan:c?0:d.length})}))}},{render:function(){return!1}},c.invert({EntityCategory:"displayName"}))),
L=f(c.defaults({propTypes:{conn:d.object.isRequired,entityEditor:d.any.isRequired,auxiliary:d.object,customFilter:d.func},getInitialState:function(){return{tableData:{data:[]}}},registerCallback:function(){var a=this;return this.props.conn.registerCallback(function(e){return a.setState({tableData:e})})},componentDidMount:function(){return this.registerCallback()},componentDidUpdate:function(){return this.registerCallback()},componentWillUnmount:function(){return this.props.conn.close()},componentWillReceiveProps:function(a){return this.props.conn.pathname()!==
a.conn.pathname()?this.props.conn.close():void 0},render:function(){var b=this,e=p[l.location.pathname].dataSpec,g=(this.props.customFilter||c.identity)(this.state.tableData.data),d=null===e.categoryColumn?function(){var k=c.sortBy(g,e.columns[0][0]);console.log(b.state.tableData);console.log(g);console.log(k);return a("tbody",{},h(k,function(e){return a(E,{firstRowSpan:1,entityEditor:b.props.entityEditor,auxiliary:b.props.auxiliary,entity:e,key:e.id})}))}():function(){var k=e.categoryColumn[0],d=
e.columns[0][0],I=h(c.sortBy(h(c.groupBy(g,k),function(a,b){return{k:b,v:c.sortBy(a,d)}}),"k"),function(a){return a.v});return h(I,function(e){return a(K,{entities:e,entityEditor:b.props.entityEditor,auxiliary:b.props.auxiliary,key:e[0][k]})})}(),k=function(a){return"[object Function]"===Object.prototype.toString.call(a)?a(g):a},f=h((null===e.categoryColumn?[]:[k(e.categoryColumn[2])]).concat(h(e.columns,function(a){return k(a[2])})),function(b,e){return a("th",{key:e},b)});return a("div",{className:"table-responsive"},
a("table",{className:"table"},a("thead",{},a("tr",{},f,"PrivAdmin"===r?a("th",{}):null)),d))}},{render:function(){return!1}},c.invert({EntityTable:"displayName"}))),C=f(c.defaults({propTypes:{canClose:d.bool.isRequired,title:d.node.isRequired,buttons:d.node,children:d.node.isRequired},render:function(){var b=a("div",{className:"modal-header"},this.props.canClose?a("button",{type:"button",className:"close",id:"modalClose","data-dismiss":"modal"},a("span",{"aria-hidden":"true"},"\u00d7"),a("span",{className:"sr-only"},
"Close")):"",a("h4",{className:"modal-title"},this.props.title)),e=this.props.buttons?a("div",{className:"modal-footer"},this.props.buttons):"";return a("div",{id:"modal",className:"modal fade"},a("div",{className:"modal-dialog"},a("div",{className:"modal-content"},b,a("div",{className:"modal-body"},this.props.children),e)))},componentDidMount:function(){return m(this.getDOMNode()).on("hidden.bs.modal",function(){return u.unmountComponentAtNode(q())}).modal({keyboard:!1,backdrop:"static"})}},{render:function(){return!1}},
c.invert({Modal:"displayName"}))),q=function(){return m("#modal-wrapper").get(0)},D=function(){return m("#modal").modal("hide")},F=f(c.defaults({propTypes:{actionButtonType:d.string,actionButtonStyle:d.string.isRequired,actionButtonLabel:d.node.isRequired,title:d.node.isRequired,children:d.node.isRequired,next:d.func.isRequired},getInitialState:function(){return{spinner:0}},render:function(){var b=this,e=a("div",{},a("img",{width:16,height:16,src:"/static/res/loading.gif",style:{display:this.state.spinner?
"inline":"none"}}),a("div",{style:{display:this.state.spinner?"none":"block"}},a("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},"Cancel"),a("button",{type:this.props.actionButtonType||"button",className:"btn btn-"+this.props.actionButtonStyle,onClick:function(a){a.preventDefault();return b.props.next(function(){return D()},function(a){return b.setState({spinner:a})})}},this.props.actionButtonLabel)));return a(C,{canClose:!0,title:this.props.title,buttons:e},this.props.children)}},
{render:function(){return!1}},c.invert({ActionModal:"displayName"}))),v=f(c.defaults({propTypes:{actionButtonType:d.string,actionButtonStyle:d.string.isRequired,actionButtonLabel:d.node.isRequired,title:d.node.isRequired,children:d.node.isRequired,ajaxParam:d.func.isRequired},getInitialState:function(){return{err:null}},render:function(){var b=this;return a(F,{title:this.props.title,actionButtonLabel:this.props.actionButtonLabel,actionButtonStyle:this.props.actionButtonStyle,actionButtonType:this.props.actionButtonType,
next:function(a,g){g(1);var d=c.defaults(b.props.ajaxParam.apply(b),{success:a,error:function(a){g(0);console.log("Ajax error.");console.log(a);a=JSON.parse(a.responseText);return b.setState({err:a.meta.details})}});return m.ajax(d)}},this.state.err?a("div",{className:"alert alert-danger",role:"alert"},this.state.err):null,this.props.children)}},{render:function(){return!1}},c.invert({AjaxFailableActionModal:"displayName"}))),w=f(c.defaults({propTypes:{entityTypeHumanName:d.string.isRequired,entityTypeMachineName:d.string.isRequired,
entity:d.object,children:d.node.isRequired},getInitialState:function(){return{err:null}},render:function(){var b=this.props.entityTypeHumanName,e=this.props.entityTypeMachineName,c=this.props.entity?"/api/"+e+"/"+this.props.entity.id:"/api/"+e,d=this.props.entity?"PUT":"POST";return a("form",{id:"editorForm",role:"form"},a(v,{title:this.props.entity?"Edit "+b:"Add a new "+b,actionButtonLabel:this.props.entity?"Edit":"Add",actionButtonStyle:"primary",actionButtonType:"submit",ajaxParam:function(){return{url:c,
type:d,data:m("#editorForm").serialize()}}},this.props.children))}},{render:function(){return!1}},c.invert({RecordEditor:"displayName"}))),z=f(c.defaults({propTypes:{entity:d.object},render:function(){return a(w,{entity:this.props.entity,entityTypeHumanName:"CCA",entityTypeMachineName:"ccas"},a("div",{className:"form-group"},a("label",{htmlFor:"name"},"CCA Name"),a("input",{type:"text",className:"form-control",name:"name",placeholder:"e.g. Infocomm Club",defaultValue:this.props.entity?this.props.entity.name:
""})),a("div",{className:"form-group"},a("label",{htmlFor:"category"},"CCA Category"),a("input",{type:"text",className:"form-control",name:"category",placeholder:"e.g. Clubs and Societies",defaultValue:this.props.entity?this.props.entity.category:""})))}},{render:function(){return!1}},c.invert({CcaEditor:"displayName"}))),A=f(c.defaults({propTypes:{entity:d.object},getInitialState:function(){return{compulsory:this.props.entity?null===this.props.entity.code:!1}},render:function(){var b=this;return a(w,
{entity:this.props.entity,entityTypeHumanName:"Subject",entityTypeMachineName:"subjects"},a("div",{className:"form-group"},a("label",{htmlFor:"name"},"Subject Name"),a("input",{type:"text",className:"form-control",name:"name",placeholder:"e.g. Mathematics (H3)",defaultValue:this.props.entity?this.props.entity.name:""}),a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",onChange:function(a){return b.setState({compulsory:a.target.checked})},checked:this.state.compulsory}),"This is a compulsory subject.")),
a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",name:"science",defaultChecked:this.props.entity?this.props.entity.is_science:!1}),"This is a science subject."))),a("div",{className:"form-group"},a("label",{htmlFor:"code"},"Subject Code"),this.state.compulsory?a("input",{type:"text",className:"form-control",disabled:!0,value:"",placeholder:"None"}):a("input",{type:"text",className:"form-control",name:"code",placeholder:"e.g. MA(H3)",defaultValue:this.props.entity?this.props.entity.code:
""}),a("p",{className:"help-block"},"Compulsory subjects do not have a subject code, because since everyone takes them, there is no reason to specify them in CSV. They will, however, still appear on PDF files if they are also science subjects.")),a("div",{className:"form-group"},a("label",{htmlFor:"level"},"Applies To"),a("div",{className:"checkbox"},h([1,2,3,4,5,6],function(e){var g=b.props.entity?-1!==c.indexOf(b.props.entity.level,e):!1;return a("label",{key:e,className:"checkbox-inline"},a("input",
{type:"checkbox",name:"level",value:e,defaultChecked:g}),"Year ",e)}))),a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",name:"force",defaultChecked:!1}),"Force the operation to continue despite errors (not recommended).")))}},{render:function(){return!1}},c.invert({SubjectEditor:"displayName"}))),M=f(c.defaults({render:function(){return a(v,{actionButtonStyle:"primary",actionButtonLabel:"Upload",title:"Add Students via Uploading CSV File",ajaxParam:function(){var a=new FormData(m("#uploaderForm").get(0));
console.log(a);return{url:"/api/students/csv",type:"POST",data:a,contentType:!1,processData:!1}}},a("form",{id:"uploaderForm",role:"form"},a("p",{className:"help-block"},"This allows you to upload a CSV file of students and add all of them. This is an all-or-nothing operation: even if only one student could not be added, none of the students will be added."),a("div",{className:"form-group"},a("label",{htmlFor:"csv"},"CSV File"),a("input",{type:"file",className:"form-control",name:"csv",accept:"text/csv,.csv",
required:!0}))))}},{render:function(){return!1}},c.invert({BatchUploadStudents:"displayName"}))),N=f(c.defaults({getInitialState:function(){return{decodeResult:null}},render:function(){var b=this,e=function(a){return h(a,function(a){return a.name}).join(", ")};return a(F,{actionButtonStyle:"primary",actionButtonLabel:"Decode",title:"Test Decode Subject Codes",next:function(a,e){e(1);return m.getJSON("/api/subjects/test-decode",m("#decoderForm").serialize(),function(a){e(0);return b.setState({decodeResult:a.data})})}},
this.state.decodeResult?a("div",{className:"panel panel-default"},a("div",{className:"panel-heading"},"Decode Results"),a("div",{className:"panel-body"},0===this.state.decodeResult.length?"The subject codes could not be decoded at all.":1===this.state.decodeResult.length?a("div",{},"The subject codes could be unambiguously decoded: ",a("br",{}),e(this.state.decodeResult[0])):a("div",{},"The subject codes could not be unambiguously decoded; here are the possibilities:",a("ul",{},h(this.state.decodeResult,
function(b){return a("li",{},e(b))}))))):null,a("form",{id:"decoderForm",role:"form"},a("p",{className:"help-block"},"This decoder allows you to preview decoding of a set of subject codes. You can enter a series of subject codes and see how it will be decoded."),a("div",{className:"form-group"},a("label",{htmlFor:"level"},"Year"),a("div",{className:"radio"},h([1,2,3,4,5,6],function(b){return a("label",{key:b,className:"checkbox-inline"},a("input",{type:"radio",name:"level",value:b,defaultChecked:1===
b}),"Year ",b)}))),a("div",{className:"form-group"},a("label",{htmlFor:"str"},"Subject Code Combination"),a("input",{type:"text",className:"form-control",name:"str",placeholder:"Enter subject codes here"}))))}},{render:function(){return!1}},c.invert({TestDecoder:"displayName"}))),B=f(c.defaults({propTypes:{entity:d.object},render:function(){return a(w,{entity:this.props.entity,entityTypeHumanName:"Teacher",entityTypeMachineName:"teachers"},a("div",{className:"form-group"},a("label",{htmlFor:"name"},
"Teacher Name"),a("input",{type:"text",className:"form-control",name:"name",placeholder:"e.g. Chow Ban Hoe",defaultValue:this.props.entity?this.props.entity.name:""}),a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",name:"admin",defaultChecked:this.props.entity?this.props.entity.is_admin:!1}),"This teacher is an administrator."))),a("div",{className:"form-group"},a("label",{htmlFor:"witness"},"Witness Name (Capital, with Salutation)"),a("input",{type:"text",className:"form-control",
name:"witness",placeholder:"e.g. MR CHOW BAN HOE",defaultValue:this.props.entity?this.props.entity.witness_name:""})),a("div",{className:"form-group"},a("label",{htmlFor:"email"},"Email Address"),a("input",{type:"email",className:"form-control",name:"email",placeholder:"e.g. chow_ban_hoe@moe.edu.sg",defaultValue:this.props.entity?this.props.entity.email:""})),a("div",{className:"form-group"},a("label",{htmlFor:"unit"},"Unit"),a("input",{type:"email",className:"form-control",name:"unit",placeholder:"e.g. Bio",
defaultValue:this.props.entity?this.props.entity.unit:""})))}},{render:function(){return!1}},c.invert({TeacherEditor:"displayName"}))),O=f(c.defaults({propTypes:{auxiliary:d.object.isRequired,entity:d.object},getInitialState:function(){return{currentLevel:this.props.entity?this.props.entity["class"][0]:void 0}},render:function(){var b=this;return a(w,{entity:this.props.entity,entityTypeHumanName:"Student",entityTypeMachineName:"students"},a("div",{className:"form-group"},a("label",{htmlFor:"class"},
"Class"),a("input",{type:"text",className:"form-control",name:"class",placeholder:"e.g. 5N",defaultValue:this.props.entity?this.props.entity["class"].join(""):"",onChange:function(a){a=/^([1-6])[A-NP-Z]$/.exec(a.target.value);return b.setState({currentLevel:a?parseInt(a[1],10):null})}})),a("div",{className:"form-group"},a("label",{htmlFor:"indexno"},"Register Number"),a("input",{type:"number",className:"form-control",name:"indexno",placeholder:"e.g. 22",defaultValue:this.props.entity?this.props.entity.index_number:
""})),a("div",{className:"form-group"},a("label",{htmlFor:"name"},"Full Name"),a("input",{type:"text",className:"form-control",name:"name",inputMode:"latin-name",defaultValue:this.props.entity?this.props.entity.name:""})),a("div",{className:"form-group"},a("label",{htmlFor:"chinesename"},"Chinese Name"),a("input",{type:"text",className:"form-control",name:"chinesename",inputMode:"kana",defaultValue:this.props.entity?this.props.entity.chinese_name:""})),a("div",{className:"form-group"},a("label",{htmlFor:"nric"},
"Partial NRIC"),a("input",{type:"text",className:"form-control",name:"nric",inputMode:"verbatim",defaultValue:this.props.entity?this.props.entity.nric:""})),a("div",{className:"form-group"},a("label",{htmlFor:"witnesser"},"Witness"),a("select",{className:"form-control",name:"witness",defaultValue:this.props.entity?this.props.entity.witnesser:""},[a("option",{key:0,value:""},"None")].concat(h(this.props.auxiliary.teacherInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",b.witness_name,
")")})))),a("div",{className:"form-group"},a("label",{htmlFor:"subj"},"Subject Combination"),a("div",{className:"checkbox"},this.state.currentLevel?h(c.filter(b.props.auxiliary.subjectInfo.data,function(a){return c.contains(a.level,b.state.currentLevel)&&null!==a.code}),function(e,g){return a("label",{className:"checkbox-inline",key:e.id},a("input",{type:"checkbox",name:"subj",value:1+g,defaultChecked:b.props.entity?c.contains(b.props.entity.subject_combi,e.id):!1}),e.name," (",e.code,")")}):a("p",
{className:"help-block"},"Subjects are not available for selection because you did not correctly enter a class."))))}},{render:function(){return!1}},c.invert({StudentEditor:"displayName"}))),J=f(c.defaults({propTypes:{entity:d.object.isRequired},render:function(){var b=p[l.location.pathname].dataSpec,e=b.humanName,c="/api/"+b.machineName+"/"+this.props.entity.id;return a(v,{title:"Delete "+e,actionButtonLabel:"Delete",actionButtonStyle:"danger",ajaxParam:function(){return{url:c,type:"DELETE"}}},a("p",
{},"Are you sure you want to delete the ",e," \u201c",this.props.entity.name,"\u201d from the database?"))}},{render:function(){return!1}},c.invert({DeleteConfirmation:"displayName"}))),P=f(c.defaults({render:function(){return a("div",{className:"row"},a("div",{className:"col-sm-11 col-md-8 col-lg-7"},a("h2",{},"Welcome"),a("p",{},"Welcome to the admin console for RVHS Science Lab Undertaking Project. Click Manage Students from the tab above to view information about students.","PrivAdmin"===r?" As an administrator, you can also manage other things from the above tabs.":
null)))}},{render:function(){return!1}},c.invert({AdminHomeR:"displayName"}))),x=f(c.defaults({propTypes:{customButtons:d.node,wsUrl:d.string,auxiliary:d.object,customFilter:d.func},getInitialState:function(){var a=p[l.location.pathname].dataSpec.machineName;return{conn:t(this.props.wsUrl||"/api/"+a)}},componentWillReceiveProps:function(a){a.wsUrl!==this.props.wsUrl?(this.state.conn.close(),a=this.setState({conn:t(a.wsUrl)})):a=void 0;return a},render:function(){var b=this,e=p[l.location.pathname].dataSpec,
c=e.humanNamePlural,d=e.machineName,k=e.editor,e=function(){return n.render(a(v,{title:"Deleting All "+c,actionButtonLabel:"Yes, Delete All",actionButtonStyle:"danger",ajaxParam:function(){return{url:"/api/"+d,type:"DELETE"}}},a("p",{},"Are you sure you want to delete all ",c," currently stored in the database? ")),q())};return a("div",{},"PrivAdmin"===r?a("div",{className:"pull-right btn-group",role:"toolbar","aria-label":"Action Buttons"},this.props.customButtons?this.props.customButtons:null,a("button",
{type:"button",className:"btn btn-default",onClick:function(){return n.render(a(k,{auxiliary:b.props.auxiliary}),q())}},"Add New"),a("button",{type:"button",className:"btn btn-default",onClick:e},"Remove All (Even If Not Shown)")):null,a("h2",{},"View "+c),this.props.children,a(L,{conn:this.state.conn,entityEditor:k,auxiliary:this.props.auxiliary,customFilter:this.props.customFilter}))},shouldComponentUpdate:function(a){return!c.isEqual(this.props,a)}},{render:function(){return!1}},c.invert({EntityPage:"displayName"}))),
Q=f(c.defaults({render:function(){return a(x,{})}},{render:function(){return!1}},c.invert({AdminCcasR:"displayName"}))),R=f(c.defaults({render:function(){var b=a("button",{onClick:function(){return n.render(a(N,{}),q())},type:"button",className:"btn btn-default"},"Test Decode");return a(x,{customButtons:b})}},{render:function(){return!1}},c.invert({AdminSubjectsR:"displayName"}))),S=f(c.defaults({render:function(){return a(x,{})}},{render:function(){return!1}},c.invert({AdminTeachersR:"displayName"}))),
T=f(c.defaults({getInitialState:function(){var a=this,c=t("/api/ccas"),d=t("/api/teachers"),h=t("/api/subjects"),k=t("/api/classes");c.registerCallback(function(c){return a.setState({ccaInfo:c})});d.registerCallback(function(c){return a.setState({teacherInfo:c})});h.registerCallback(function(c){return a.setState({subjectInfo:c})});k.registerCallback(function(c){return a.setState({classInfo:c})});k={data:[]};return{queryString:"searchby=none",selected:"class",hideWithoutWitness:!0,ccaConn:c,teacherConn:d,
subjectConn:h,ccaInfo:k,teacherInfo:k,subjectInfo:k,classInfo:k}},componentWillUnmount:function(){this.state.ccaConn.close();this.state.teacherConn.close();return this.state.subjectConn.close()},render:function(){var b=a("button",{onClick:function(){return n.render(a(M,{}),q())},type:"button",className:"btn btn-default"},"Add New (Upload CSV File)"),e=this,d=function(a){return a.target.checked?e.setState({selected:a.target.value}):void 0},f={teacherInfo:e.state.teacherInfo,ccaInfo:e.state.ccaInfo,
subjectInfo:e.state.subjectInfo,classInfo:e.state.classInfo};return a("div",{},a("div",{className:"row"},a("h4",{className:"col-sm-9 col-sm-offset-3 col-md-7 col-md-offset-2 col-lg-6 col-lg-offset-2"},"Which students would you like to see?")),a("form",{role:"form",id:"searchbyForm",className:"form-horizontal"},a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"class",defaultChecked:!0,onChange:d}),
"Search By Class"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"class"===this.state.selected?a("select",{className:"form-control",name:"class"},h(f.classInfo.data,function(b){b=b[0]+b[1];return a("option",{value:b,key:b},b)})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"level",defaultChecked:!1,onChange:d}),"Search By Level"),a("div",
{className:"col-sm-9 col-md-7 col-lg-6"},"level"===this.state.selected?a("select",{className:"form-control",name:"level"},h(c.uniq(f.classInfo.data,!1,function(a){return a[0]}),function(b){return a("option",{value:b[0],key:b[0]},"Year ",b[0])})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"name",defaultChecked:!1,onChange:d}),"Search By Approx. Name"),
a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"name"===this.state.selected?a("input",{type:"text",className:"form-control",name:"name",placeholder:"Enter an approximate name, e.g. Xin Yi"}):a("input",{type:"text",className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"subject",defaultChecked:!1,onChange:d}),"Search By Subject"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},
"subject"===this.state.selected?a("select",{className:"form-control",name:"id"},h(f.subjectInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",h(b.level,function(a){return"Year "+a}).join(", "),")")})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"cca",defaultChecked:!1,onChange:d}),"Search By CCA"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},
"cca"===this.state.selected?a("select",{className:"form-control",name:"id"},h(f.ccaInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",b.category,")")})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"teacher",defaultChecked:!1,onChange:d}),"Search By Witness"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"teacher"===
this.state.selected?a("select",{className:"form-control",name:"id"},h(f.teacherInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",b.witness_name,")")})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"form-group"},a("div",{className:"col-sm-9 col-sm-offset-3 col-md-7 col-md-offset-2 col-lg-6 col-lg-offset-2"},a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",defaultChecked:!0,onChange:function(a){console.log(a.target.checked);return e.setState({hideWithoutWitness:a.target.checked})}}),
" Hide Students Without Witness")))),a("div",{className:"form-group"},a("div",{className:"col-sm-9 col-sm-offset-3 col-md-7 col-md-offset-2 col-lg-6 col-lg-offset-2"},a("button",{type:"submit",className:"btn btn-primary",onClick:function(a){a.preventDefault();return e.setState({queryString:m("#searchbyForm").serialize()})}},"View")))),a("div",{className:"row"},a(x,{wsUrl:"/api/students?"+this.state.queryString,auxiliary:f,customButtons:b,customFilter:function(a){return e.state.hideWithoutWitness?
c.filter(a,function(a){return a.witnesser}):a}})))}},{render:function(){return!1}},c.invert({AdminStudentsR:"displayName"}))),y=function(a,e){return c.find(a.data,function(a){return e===a.id})||"??"},U=f(c.defaults({propTypes:{sub:d.object.isRequired,ccaInfo:d.object.isRequired,onLockClick:d.func.isRequired,onUnlockClick:d.func.isRequired},render:function(){var b=this,c=a("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},"OK");return a(C,{canClose:!0,title:"Student-Submitted Information",
buttons:c},a("table",{className:"table"},a("tbody",{},a("tr",{},a("th",{},"Email"),a("td",{},this.props.sub.email)),a("tr",{},a("th",{},"Phone Number"),a("td",{},this.props.sub.phone)),a("tr",{},a("th",{},"Date of Submission"),a("td",{},this.props.sub.date)),a("tr",{},a("th",{},"CCAs"),a("td",{},h(this.props.sub.cca,function(a){return y(b.props.ccaInfo,a).name}).join(", ")||"None")),a("tr",{},a("th",{},"Delete Submission"),a("td",{},a("div",{className:"btn-toolbar",role:"toolbar"},a("button",{type:"button",
className:"btn btn-default",onClick:function(){b.props.onUnlockClick();return D()}},"Delete and Unlock"),a("button",{type:"button",className:"btn btn-default",onClick:function(){b.props.onLockClick();return D()}},"Delete and Lock")))))))}},{render:function(){return!1}},c.invert({SubmissionCompleteModal:"displayName"}))),p={"/admin":{pageName:"Home",onlyAdmin:!1,component:P,dataSpec:null},"/admin/ccas":{pageName:"Manage CCAs",onlyAdmin:!0,component:Q,dataSpec:{humanName:"CCA",humanNamePlural:"CCAs",
machineName:"ccas",editor:z,categoryColumn:["category",c.identity,"CCA Category"],columns:[["name",c.identity,"CCA Name"]]}},"/admin/subjects":{pageName:"Manage Subjects",onlyAdmin:!0,component:R,dataSpec:{humanName:"Subject",humanNamePlural:"Subjects",machineName:"subjects",editor:A,categoryColumn:["level",function(a){return h(a,function(a){return"Year "+a}).join(", ")},"Applies To"],columns:[["name",c.identity,"Subject Name"],["code",function(b){return b?a("code",{},b):a("i",{},"(None; Compulsory Subject)")},
"Subject Code"],["is_science",function(a){return a?"Yes":"No"},"Science Subject?"]]}},"/admin/teachers":{pageName:"Manage Teachers",onlyAdmin:!0,component:S,dataSpec:{humanName:"Teacher",humanNamePlural:"Teachers",machineName:"teachers",editor:B,categoryColumn:null,columns:[["name",c.identity,"Name"],["unit",c.identity,"Unit"],["email",c.identity,"Email Address"],["is_admin",function(a){return a?"Yes":"No"},"Administrator?"],["witness_name",c.identity,"Witness Name"]]}},"/admin/students":{pageName:"Manage Students",
onlyAdmin:!1,component:T,dataSpec:{humanName:"Student",humanNamePlural:"Students",machineName:"students",editor:O,categoryColumn:["class",c.identity,"Class"],columns:[["index_number",c.identity,"Index #"],["name",c.identity,"Name"],["chinese_name",c.identity,"Chinese"],["nric",function(a){return a.slice(-5)},"ID"],["subject_combi",function(b){var c=this,d=h(b,function(a){return y(c.subjectInfo,a).code}).join(", ");b=h(b,function(a){return y(c.subjectInfo,a).name}).join(", ");return d?a("span",{title:b},
d):"\u2014"},"Subject(s)"],["witnesser",function(b){return null===b?a("i",{},"None"):y(this.teacherInfo,b).name},"Witness"],["submission",function(a){return a.email||"\u2014"},"Email"],["submission",function(a){return a.phone||"\u2014"},"Phone"],["submission",function(b){return b.final_declaration_filename?a("a",{className:"btn btn-default btn-xs",target:"_blank",href:"https://rvhs-sci-lab-undertaking.appspot.com/storage?filename="+encodeURIComponent(b.final_declaration_filename)},a("span",{className:"glyphicon glyphicon-floppy-save",
"aria-hidden":"true"})):"SubmissionCompleted"===b.tag?a("img",{src:"/static/res/loading.gif",width:16,height:16,style:{margin:"0 4px"}}):void 0},"PDF"],["submission",function(b,c){var d=this,f=a("span",{className:"glyphicon glyphicon-lock","aria-hidden":"true"}),k=a("span",{className:"glyphicon glyphicon-ok","aria-hidden":"true"}),h=function(){return m.ajax("/api/students/"+c.id+"/unlock",{type:"POST"})},l=function(){return m.ajax("/api/students/"+c.id+"/lock",{type:"POST"})},p=function(){return n.render(a(U,
{ccaInfo:d.ccaInfo,sub:b,onLockClick:l,onUnlockClick:h}),q())};return a("div",{className:"btn-group",role:"toolbar","aria-label":"Status Buttons"},"SubmissionNotOpen"===b.tag?a("button",{type:"button",className:"btn btn-danger btn-xs",onClick:h,title:"Click to unlock submission."},f,a("span",{className:"presentation-text","data-text":" Locked"})):"SubmissionOpen"===b.tag?a("button",{type:"button",className:"btn btn-primary btn-xs",onClick:l,title:"Click to lock submission."},f,a("span",{className:"presentation-text",
"data-text":" Unlocked"})):"SubmissionCompleted"===b.tag?a("button",{type:"button",className:"btn btn-success btn-xs",onClick:p,title:"Click to view submitted information."},k,a("span",{className:"presentation-text","data-text":" Completed"})):void 0)},function(b){var c=a("span",{className:"glyphicon glyphicon-lock","aria-hidden":"true"});a("span",{className:"glyphicon glyphicon-ok","aria-hidden":"true"});return a("span",{},a("button",{type:"button",className:"btn btn-primary btn-xs",onClick:function(){var a=
h(b,"id").join(",");return m.ajax("/api/students/many/unlock",{type:"POST",data:{ids:a}})},title:"Click to unlock submission for all."},c,a("span",{className:"presentation-text","data-text":" Unlock These"}))," ",a("button",{type:"button",className:"btn btn-danger btn-xs",onClick:function(){var a=h(b,"id").join(",");return m.ajax("/api/students/many/lock",{type:"POST",data:{ids:a}})},title:"Click to lock submission for all."},c,a("span",{className:"presentation-text","data-text":" Lock These"})))}]]}}},
f=f(c.defaults({render:function(){var b=l.location.pathname,c=h(p,function(c,d){var e=a("li",{key:d,role:"presentation",className:d===b?"active":""},a("a",{href:d===b?"#":d},c.pageName));return c.onlyAdmin?"PrivAdmin"===r?e:null:e});return a("div",{id:"content-wrapper"},a("div",{id:"popover-wrapper"}),a("div",{id:"modal-wrapper"}),a("div",{className:"container"},a("div",{className:"page-header"},a("h1",{},a("img",{src:"/static/res/rv.png",style:{height:"1em",position:"relative",top:"-0.2em",margin:"0 0.3em 0 0"}}),
"RVHS Science Lab Undertaking \u2014 For Teachers")),a("p",{},"You are logged in as "+H+". ","PrivAdmin"===r?"You are an administrator. ":null,a("a",{href:"/auth/logout"},"Click here to logout. ")),a("div",{role:"tabpanel"},a("ul",{className:"nav nav-tabs"},c)),a("div",{id:"main-content"})))},componentDidMount:function(){var b=l.location.pathname;return"undefined"===typeof l.EventSource?n.render(a(C,{canClose:!0,title:"Browser Unsupported"},a("p",{},"Your browser is unsupported. Although you may still be able to use this site, it is ",
a("b",{},"highly recommended")," that you use a different browser, such as Google Chrome 9 or higher, Mozilla Firefox 6 or higher, or Apple Safari 5 or higher. Internet Explorer is known to behave inconsistently and therefore should not be used.")),q()):n.render(a(p[b].component,{}),m("#main-content").get(0))}},{render:function(){return!1}},c.invert({Page:"displayName"})));return n.render(a(f,{}),G.getElementById("body"))})})(window,document,React,ReactDOM,$,_);
