'use strict';$(function(){var a=React.createElement,f=React.createClass,d=React.PropTypes,g=_.map,x=$("#meta-user").attr("value"),l=$("#meta-priv").attr("value"),n=function(a){var c=("https:"===window.location.protocol?"wss://":"ws://")+window.location.host+a,e=null,d=null,h=null,g=function(){return 2E3<Date.now()-h?function(){h=Date.now();e=new WebSocket(c);e.onmessage=d;e.onerror=function(){console.log("WS connection errored.");return g()};e.onclose=function(a){console.log(a);return console.log("WS connection closed.")}}():
setTimeout(g,Date.now()-h)};$(window).on("beforeunload",function(){return e.close()});return{registerCallback:function(a){e?_.noop():g();var b=function(b){return a(JSON.parse(b.data))};d=e.onmessage=b},pathname:function(){return a},close:function(){e.onmessage=_.noop;e.onerror=_.noop;e.onclose=_.noop;return e.close()}}},v=f(_.defaults({propTypes:{firstRowSpan:d.number.isRequired,entity:d.object.isRequired,entityEditor:d.any.isRequired,auxiliary:d.object},render:function(){var b=this,c=k[window.location.pathname].dataSpec,
e=null!==c.categoryColumn&&b.props.firstRowSpan?a("td",{rowSpan:b.props.firstRowSpan},c.categoryColumn[1].apply(b.props.auxiliary,[b.props.entity[c.categoryColumn[0]],b.props.entity])):null,d=function(){return React.render(a(b.props.entityEditor,{auxiliary:b.props.auxiliary,entity:b.props.entity}),m())},h=function(){return React.render(a(z,{auxiliary:b.props.auxiliary,entity:b.props.entity}),m())};return a("tr",{},e,g(c.columns,function(c,e){return a("td",{key:e},c[1].apply(b.props.auxiliary,[b.props.entity[c[0]],
b.props.entity]))}),"PrivAdmin"===l?a("td",{className:"text-right"},a("div",{className:"btn-group",role:"group"},a("button",{type:"button",className:"btn btn-default btn-xs",title:"Edit",onClick:d},a("span",{className:"glyphicon glyphicon-pencil","aria-hidden":"true"})),a("button",{type:"button",className:"btn btn-default btn-xs",title:"Delete",onClick:h},a("span",{className:"glyphicon glyphicon-trash","aria-hidden":"true"})))):null)}},{render:function(){return!1}},_.invert({EntityRow:"displayName"}))),
A=f(_.defaults({propTypes:{entities:d.array.isRequired,entityEditor:d.any.isRequired,auxiliary:d.object},render:function(){var b=this;return a("tbody",{},g(this.props.entities,function(c,e,d){return a(v,{key:c.id,entityEditor:b.props.entityEditor,auxiliary:b.props.auxiliary,entity:c,firstRowSpan:e?0:d.length})}))}},{render:function(){return!1}},_.invert({EntityCategory:"displayName"}))),B=f(_.defaults({propTypes:{conn:d.object.isRequired,entityEditor:d.any.isRequired,auxiliary:d.object,customFilter:d.func},
getInitialState:function(){return{tableData:{data:[]}}},registerCallback:function(){var a=this;return this.props.conn.registerCallback(function(c){return a.setState({tableData:c})})},componentDidMount:function(){return this.registerCallback()},componentDidUpdate:function(){return this.registerCallback()},componentWillUnmount:function(){return this.props.conn.close()},componentWillReceiveProps:function(a){return this.props.conn.pathname()!==a.conn.pathname()?this.props.conn.close():void 0},render:function(){var b=
this,c=k[window.location.pathname].dataSpec,e=(this.props.customFilter||_.identity)(this.state.tableData.data),d=null===c.categoryColumn?function(){var h=_.sortBy(e,c.columns[0][0]);console.log(b.state.tableData);console.log(e);console.log(h);return a("tbody",{},g(h,function(c){return a(v,{firstRowSpan:1,entityEditor:b.props.entityEditor,auxiliary:b.props.auxiliary,entity:c,key:c.id})}))}():function(){var h=c.categoryColumn[0],d=c.columns[0][0],y=g(_.sortBy(g(_.groupBy(e,h),function(a,b){return{k:b,
v:_.sortBy(a,d)}}),"k"),function(a){return a.v});return g(y,function(c){return a(A,{entities:c,entityEditor:b.props.entityEditor,auxiliary:b.props.auxiliary,key:c[0][h]})})}(),h=function(a){return"[object Function]"===Object.prototype.toString.call(a)?a(e):a},f=g((null===c.categoryColumn?[]:[h(c.categoryColumn[2])]).concat(g(c.columns,function(a){return h(a[2])})),function(b,c){return a("th",{key:c},b)});return a("div",{className:"table-responsive"},a("table",{className:"table"},a("thead",{},a("tr",
{},f,"PrivAdmin"===l?a("th",{}):null)),d))}},{render:function(){return!1}},_.invert({EntityTable:"displayName"}))),t=f(_.defaults({propTypes:{canClose:d.bool.isRequired,title:d.node.isRequired,buttons:d.node,children:d.node.isRequired},render:function(){var b=a("div",{className:"modal-header"},this.props.canClose?a("button",{type:"button",className:"close",id:"modalClose","data-dismiss":"modal"},a("span",{"aria-hidden":"true"},"\u00d7"),a("span",{className:"sr-only"},"Close")):"",a("h4",{className:"modal-title"},
this.props.title)),c=this.props.buttons?a("div",{className:"modal-footer"},this.props.buttons):"";return a("div",{id:"modal",className:"modal fade"},a("div",{className:"modal-dialog"},a("div",{className:"modal-content"},b,a("div",{className:"modal-body"},this.props.children),c)))},componentDidMount:function(){return $(this.getDOMNode()).on("hidden.bs.modal",function(){return React.unmountComponentAtNode(m())}).modal({keyboard:!1,backdrop:"static"})}},{render:function(){return!1}},_.invert({Modal:"displayName"}))),
m=function(){return $("#modal-wrapper").get(0)},u=function(){return $("#modal").modal("hide")},w=f(_.defaults({propTypes:{actionButtonType:d.string,actionButtonStyle:d.string.isRequired,actionButtonLabel:d.node.isRequired,title:d.node.isRequired,children:d.node.isRequired,next:d.func.isRequired},getInitialState:function(){return{spinner:0}},render:function(){var b=this,c=a("div",{},a("img",{width:16,height:16,src:"/static/res/loading.gif",style:{display:this.state.spinner?"inline":"none"}}),a("div",
{style:{display:this.state.spinner?"none":"block"}},a("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},"Cancel"),a("button",{type:this.props.actionButtonType||"button",className:"btn btn-"+this.props.actionButtonStyle,onClick:function(a){a.preventDefault();return b.props.next(function(){return u()},function(a){return b.setState({spinner:a})})}},this.props.actionButtonLabel)));return a(t,{canClose:!0,title:this.props.title,buttons:c},this.props.children)}},{render:function(){return!1}},
_.invert({ActionModal:"displayName"}))),p=f(_.defaults({propTypes:{actionButtonType:d.string,actionButtonStyle:d.string.isRequired,actionButtonLabel:d.node.isRequired,title:d.node.isRequired,children:d.node.isRequired,ajaxParam:d.func.isRequired},getInitialState:function(){return{err:null}},render:function(){var b=this;return a(w,{title:this.props.title,actionButtonLabel:this.props.actionButtonLabel,actionButtonStyle:this.props.actionButtonStyle,actionButtonType:this.props.actionButtonType,next:function(a,
e){e(1);var d=_.defaults(b.props.ajaxParam.apply(b),{success:a,error:function(a){e(0);console.log("Ajax error.");console.log(a);a=JSON.parse(a.responseText);return b.setState({err:a.meta.details})}});return $.ajax(d)}},this.state.err?a("div",{className:"alert alert-danger",role:"alert"},this.state.err):null,this.props.children)}},{render:function(){return!1}},_.invert({AjaxFailableActionModal:"displayName"}))),q=f(_.defaults({propTypes:{entityTypeHumanName:d.string.isRequired,entityTypeMachineName:d.string.isRequired,
entity:d.object,children:d.node.isRequired},getInitialState:function(){return{err:null}},render:function(){var b=this.props.entityTypeHumanName,c=this.props.entityTypeMachineName,e=this.props.entity?"/api/"+c+"/"+this.props.entity.id:"/api/"+c,d=this.props.entity?"PUT":"POST";return a("form",{id:"editorForm",role:"form"},a(p,{title:this.props.entity?"Edit "+b:"Add a new "+b,actionButtonLabel:this.props.entity?"Edit":"Add",actionButtonStyle:"primary",actionButtonType:"submit",ajaxParam:function(){return{url:e,
type:d,data:$("#editorForm").serialize()}}},this.props.children))}},{render:function(){return!1}},_.invert({RecordEditor:"displayName"}))),C=f(_.defaults({propTypes:{entity:d.object},render:function(){return a(q,{entity:this.props.entity,entityTypeHumanName:"CCA",entityTypeMachineName:"ccas"},a("div",{className:"form-group"},a("label",{htmlFor:"name"},"CCA Name"),a("input",{type:"text",className:"form-control",name:"name",placeholder:"e.g. Infocomm Club",defaultValue:this.props.entity?this.props.entity.name:
""})),a("div",{className:"form-group"},a("label",{htmlFor:"category"},"CCA Category"),a("input",{type:"text",className:"form-control",name:"category",placeholder:"e.g. Clubs and Societies",defaultValue:this.props.entity?this.props.entity.category:""})))}},{render:function(){return!1}},_.invert({CcaEditor:"displayName"}))),D=f(_.defaults({propTypes:{entity:d.object},getInitialState:function(){return{compulsory:this.props.entity?null===this.props.entity.code:!1}},render:function(){var b=this;return a(q,
{entity:this.props.entity,entityTypeHumanName:"Subject",entityTypeMachineName:"subjects"},a("div",{className:"form-group"},a("label",{htmlFor:"name"},"Subject Name"),a("input",{type:"text",className:"form-control",name:"name",placeholder:"e.g. Mathematics (H3)",defaultValue:this.props.entity?this.props.entity.name:""}),a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",onChange:function(a){return b.setState({compulsory:a.target.checked})},checked:this.state.compulsory}),"This is a compulsory subject.")),
a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",name:"science",defaultChecked:this.props.entity?this.props.entity.is_science:!1}),"This is a science subject."))),a("div",{className:"form-group"},a("label",{htmlFor:"code"},"Subject Code"),this.state.compulsory?a("input",{type:"text",className:"form-control",disabled:!0,value:"",placeholder:"None"}):a("input",{type:"text",className:"form-control",name:"code",placeholder:"e.g. MA(H3)",defaultValue:this.props.entity?this.props.entity.code:
""}),a("p",{className:"help-block"},"Compulsory subjects do not have a subject code, because since everyone takes them, there is no reason to specify them in CSV. They will, however, still appear on PDF files if they are also science subjects.")),a("div",{className:"form-group"},a("label",{htmlFor:"level"},"Applies To"),a("div",{className:"checkbox"},g([1,2,3,4,5,6],function(c){var e=b.props.entity?-1!==_.indexOf(b.props.entity.level,c):!1;return a("label",{key:c,className:"checkbox-inline"},a("input",
{type:"checkbox",name:"level",value:c,defaultChecked:e}),"Year ",c)}))),a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",name:"force",defaultChecked:!1}),"Force the operation to continue despite errors (not recommended).")))}},{render:function(){return!1}},_.invert({SubjectEditor:"displayName"}))),E=f(_.defaults({render:function(){return a(p,{actionButtonStyle:"primary",actionButtonLabel:"Upload",title:"Add Students via Uploading CSV File",ajaxParam:function(){var a=new FormData($("#uploaderForm").get(0));
console.log(a);return{url:"/api/students/csv",type:"POST",data:a,contentType:!1,processData:!1}}},a("form",{id:"uploaderForm",role:"form"},a("p",{className:"help-block"},"This allows you to upload a CSV file of students and add all of them. This is an all-or-nothing operation: even if only one student could not be added, none of the students will be added."),a("div",{className:"form-group"},a("label",{htmlFor:"csv"},"CSV File"),a("input",{type:"file",className:"form-control",name:"csv",accept:"text/csv,.csv",
required:!0}))))}},{render:function(){return!1}},_.invert({BatchUploadStudents:"displayName"}))),F=f(_.defaults({getInitialState:function(){return{decodeResult:null}},render:function(){var b=this,c=function(a){return g(a,function(a){return a.name}).join(", ")};return a(w,{actionButtonStyle:"primary",actionButtonLabel:"Decode",title:"Test Decode Subject Codes",next:function(a,c){c(1);return $.getJSON("/api/subjects/test-decode",$("#decoderForm").serialize(),function(a){c(0);return b.setState({decodeResult:a.data})})}},
this.state.decodeResult?a("div",{className:"panel panel-default"},a("div",{className:"panel-heading"},"Decode Results"),a("div",{className:"panel-body"},0===this.state.decodeResult.length?"The subject codes could not be decoded at all.":1===this.state.decodeResult.length?a("div",{},"The subject codes could be unambiguously decoded: ",a("br",{}),c(this.state.decodeResult[0])):a("div",{},"The subject codes could not be unambiguously decoded; here are the possibilities:",a("ul",{},g(this.state.decodeResult,
function(b){return a("li",{},c(b))}))))):null,a("form",{id:"decoderForm",role:"form"},a("p",{className:"help-block"},"This decoder allows you to preview decoding of a set of subject codes. You can enter a series of subject codes and see how it will be decoded."),a("div",{className:"form-group"},a("label",{htmlFor:"level"},"Year"),a("div",{className:"radio"},g([1,2,3,4,5,6],function(b){return a("label",{key:b,className:"checkbox-inline"},a("input",{type:"radio",name:"level",value:b,defaultChecked:1===
b}),"Year ",b)}))),a("div",{className:"form-group"},a("label",{htmlFor:"str"},"Subject Code Combination"),a("input",{type:"text",className:"form-control",name:"str",placeholder:"Enter subject codes here"}))))}},{render:function(){return!1}},_.invert({TestDecoder:"displayName"}))),G=f(_.defaults({propTypes:{entity:d.object},render:function(){return a(q,{entity:this.props.entity,entityTypeHumanName:"Teacher",entityTypeMachineName:"teachers"},a("div",{className:"form-group"},a("label",{htmlFor:"name"},
"Teacher Name"),a("input",{type:"text",className:"form-control",name:"name",placeholder:"e.g. Chow Ban Hoe",defaultValue:this.props.entity?this.props.entity.name:""}),a("div",{className:"checkbox"},a("label",{},a("input",{type:"checkbox",name:"admin",defaultChecked:this.props.entity?this.props.entity.is_admin:!1}),"This teacher is an administrator."))),a("div",{className:"form-group"},a("label",{htmlFor:"witness"},"Witness Name (Capital, with Salutation)"),a("input",{type:"text",className:"form-control",
name:"witness",placeholder:"e.g. MR CHOW BAN HOE",defaultValue:this.props.entity?this.props.entity.witness_name:""})),a("div",{className:"form-group"},a("label",{htmlFor:"email"},"Email Address"),a("input",{type:"email",className:"form-control",name:"email",placeholder:"e.g. chow_ban_hoe@moe.edu.sg",defaultValue:this.props.entity?this.props.entity.email:""})),a("div",{className:"form-group"},a("label",{htmlFor:"unit"},"Unit"),a("input",{type:"email",className:"form-control",name:"unit",placeholder:"e.g. Bio",
defaultValue:this.props.entity?this.props.entity.unit:""})))}},{render:function(){return!1}},_.invert({TeacherEditor:"displayName"}))),H=f(_.defaults({propTypes:{auxiliary:d.object.isRequired,entity:d.object},getInitialState:function(){return{currentLevel:this.props.entity?this.props.entity["class"][0]:void 0}},render:function(){var b=this;return a(q,{entity:this.props.entity,entityTypeHumanName:"Student",entityTypeMachineName:"students"},a("div",{className:"form-group"},a("label",{htmlFor:"class"},
"Class"),a("input",{type:"text",className:"form-control",name:"class",placeholder:"e.g. 5N",defaultValue:this.props.entity?this.props.entity["class"].join(""):"",onChange:function(a){a=/^([1-6])[A-NP-Z]$/.exec(a.target.value);return b.setState({currentLevel:a?parseInt(a[1],10):null})}})),a("div",{className:"form-group"},a("label",{htmlFor:"indexno"},"Register Number"),a("input",{type:"number",className:"form-control",name:"indexno",placeholder:"e.g. 22",defaultValue:this.props.entity?this.props.entity.index_number:
""})),a("div",{className:"form-group"},a("label",{htmlFor:"name"},"Full Name"),a("input",{type:"text",className:"form-control",name:"name",inputmode:"latin-name",defaultValue:this.props.entity?this.props.entity.name:""})),a("div",{className:"form-group"},a("label",{htmlFor:"chinesename"},"Chinese Name"),a("input",{type:"text",className:"form-control",name:"chinesename",inputmode:"kana",defaultValue:this.props.entity?this.props.entity.chinese_name:""})),a("div",{className:"form-group"},a("label",{htmlFor:"nric"},
"Partial NRIC"),a("input",{type:"text",className:"form-control",name:"nric",inputmode:"verbatim",defaultValue:this.props.entity?this.props.entity.nric:""})),a("div",{className:"form-group"},a("label",{htmlFor:"witnesser"},"Witness"),a("select",{className:"form-control",name:"witness",defaultValue:this.props.entity?this.props.entity.witnesser:""},[a("option",{key:0,value:""},"None")].concat(g(this.props.auxiliary.teacherInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",b.witness_name,
")")})))),a("div",{className:"form-group"},a("label",{htmlFor:"subj"},"Subject Combination"),a("div",{className:"checkbox"},this.state.currentLevel?g(_.filter(b.props.auxiliary.subjectInfo.data,function(a){return _.contains(a.level,b.state.currentLevel)&&null!==a.code}),function(c,e){return a("label",{className:"checkbox-inline",key:c.id},a("input",{type:"checkbox",name:"subj",value:1+e,defaultChecked:b.props.entity?_.contains(b.props.entity.subject_combi,c.id):!1}),c.name," (",c.code,")")}):a("p",
{className:"help-block"},"Subjects are not available for selection because you did not correctly enter a class."))))}},{render:function(){return!1}},_.invert({StudentEditor:"displayName"}))),z=f(_.defaults({propTypes:{entity:d.object.isRequired},render:function(){var b=k[window.location.pathname].dataSpec,c=b.humanName,e="/api/"+b.machineName+"/"+this.props.entity.id;return a(p,{title:"Delete "+c,actionButtonLabel:"Delete",actionButtonStyle:"danger",ajaxParam:function(){return{url:e,type:"DELETE"}}},
a("p",{},"Are you sure you want to delete the ",c," \u201c",this.props.entity.name,"\u201d from the database?"))}},{render:function(){return!1}},_.invert({DeleteConfirmation:"displayName"}))),I=f(_.defaults({render:function(){return a("div",{className:"row"},a("div",{className:"col-sm-11 col-md-8 col-lg-7"},a("h2",{},"Welcome"),a("p",{},"Welcome to the admin console for RVHS Science Lab Undertaking Project. Click Manage Students from the tab above to view information about students.","PrivAdmin"===
l?" As an administrator, you can also manage other things from the above tabs.":null)))}},{render:function(){return!1}},_.invert({AdminHomeR:"displayName"}))),r=f(_.defaults({propTypes:{customButtons:d.node,wsUrl:d.string,auxiliary:d.object,customFilter:d.func},getInitialState:function(){var a=k[window.location.pathname].dataSpec.machineName;return{conn:n(this.props.wsUrl||"/api/"+a)}},componentWillReceiveProps:function(a){a.wsUrl!==this.props.wsUrl?(this.state.conn.close(),a=this.setState({conn:n(a.wsUrl)})):
a=void 0;return a},render:function(){var b=this,c=k[window.location.pathname].dataSpec,e=c.humanNamePlural,d=c.machineName,h=c.editor,c=function(){return React.render(a(p,{title:"Deleting All "+e,actionButtonLabel:"Yes, Delete All",actionButtonStyle:"danger",ajaxParam:function(){return{url:"/api/"+d,type:"DELETE"}}},a("p",{},"Are you sure you want to delete all ",e," currently stored in the database? ")),m())};return a("div",{},"PrivAdmin"===l?a("div",{className:"pull-right btn-group",role:"toolbar",
"aria-label":"Action Buttons"},this.props.customButtons?this.props.customButtons:null,a("button",{type:"button",className:"btn btn-default",onClick:function(){return React.render(a(h,{auxiliary:b.props.auxiliary}),m())}},"Add New"),a("button",{type:"button",className:"btn btn-default",onClick:c},"Remove All (Even If Not Shown)")):null,a("h2",{},"View "+e),this.props.children,a(B,{conn:this.state.conn,entityEditor:h,auxiliary:this.props.auxiliary,customFilter:this.props.customFilter}))},shouldComponentUpdate:function(a){return!_.isEqual(this.props,
a)}},{render:function(){return!1}},_.invert({EntityPage:"displayName"}))),J=f(_.defaults({render:function(){return a(r,{})}},{render:function(){return!1}},_.invert({AdminCcasR:"displayName"}))),K=f(_.defaults({render:function(){var b=a("button",{onClick:function(){return React.render(a(F,{}),m())},type:"button",className:"btn btn-default"},"Test Decode");return a(r,{customButtons:b})}},{render:function(){return!1}},_.invert({AdminSubjectsR:"displayName"}))),L=f(_.defaults({render:function(){return a(r,
{})}},{render:function(){return!1}},_.invert({AdminTeachersR:"displayName"}))),M=f(_.defaults({getInitialState:function(){var a=this,c=n("/api/ccas"),e=n("/api/teachers"),d=n("/api/subjects"),h=n("/api/classes");c.registerCallback(function(c){return a.setState({ccaInfo:c})});e.registerCallback(function(c){return a.setState({teacherInfo:c})});d.registerCallback(function(c){return a.setState({subjectInfo:c})});h.registerCallback(function(c){return a.setState({classInfo:c})});h={data:[]};return{queryString:"searchby=none",
selected:"class",hideWithoutWitness:!0,ccaConn:c,teacherConn:e,subjectConn:d,ccaInfo:h,teacherInfo:h,subjectInfo:h,classInfo:h}},componentWillUnmount:function(){this.state.ccaConn.close();this.state.teacherConn.close();return this.state.subjectConn.close()},render:function(){var b=a("button",{onClick:function(){return React.render(a(E,{}),m())},type:"button",className:"btn btn-default"},"Add New (Upload CSV File)"),c=this,d=function(a){return a.target.checked?c.setState({selected:a.target.value}):
void 0},f={teacherInfo:c.state.teacherInfo,ccaInfo:c.state.ccaInfo,subjectInfo:c.state.subjectInfo,classInfo:c.state.classInfo};return a("div",{},a("div",{className:"row"},a("h4",{className:"col-sm-9 col-sm-offset-3 col-md-7 col-md-offset-2 col-lg-6 col-lg-offset-2"},"Which students would you like to see?")),a("form",{role:"form",id:"searchbyForm",className:"form-horizontal"},a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",
name:"searchby",value:"class",defaultChecked:!0,onChange:d}),"Search By Class"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"class"===this.state.selected?a("select",{className:"form-control",name:"class"},g(f.classInfo.data,function(b){b=b[0]+b[1];return a("option",{value:b,key:b},b)})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"level",
defaultChecked:!1,onChange:d}),"Search By Level"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"level"===this.state.selected?a("select",{className:"form-control",name:"level"},g(_.uniq(f.classInfo.data,!1,function(a){return a[0]}),function(b){return a("option",{value:b[0],key:b[0]},"Year ",b[0])})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",
value:"name",defaultChecked:!1,onChange:d}),"Search By Approx. Name"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"name"===this.state.selected?a("input",{type:"text",className:"form-control",name:"name",placeholder:"Enter an approximate name, e.g. Xin Yi"}):a("input",{type:"text",className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"subject",defaultChecked:!1,
onChange:d}),"Search By Subject"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"subject"===this.state.selected?a("select",{className:"form-control",name:"id"},g(f.subjectInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",g(b.level,function(a){return"Year "+a}).join(", "),")")})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",
value:"cca",defaultChecked:!1,onChange:d}),"Search By CCA"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"cca"===this.state.selected?a("select",{className:"form-control",name:"id"},g(f.ccaInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",b.category,")")})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"radio form-group"},a("label",{className:"col-sm-3 col-md-2 col-lg-2 control-label"},a("input",{type:"radio",name:"searchby",value:"teacher",defaultChecked:!1,
onChange:d}),"Search By Witness"),a("div",{className:"col-sm-9 col-md-7 col-lg-6"},"teacher"===this.state.selected?a("select",{className:"form-control",name:"id"},g(f.teacherInfo.data,function(b){return a("option",{value:b.id,key:b.id},b.name," (",b.witness_name,")")})):a("select",{className:"form-control",disabled:!0}))),a("div",{className:"form-group"},a("div",{className:"col-sm-9 col-sm-offset-3 col-md-7 col-md-offset-2 col-lg-6 col-lg-offset-2"},a("div",{className:"checkbox"},a("label",{},a("input",
{type:"checkbox",defaultChecked:!0,onChange:function(a){console.log(a.target.checked);return c.setState({hideWithoutWitness:a.target.checked})}}," Hide Students Without Witness"))))),a("div",{className:"form-group"},a("div",{className:"col-sm-9 col-sm-offset-3 col-md-7 col-md-offset-2 col-lg-6 col-lg-offset-2"},a("button",{type:"submit",className:"btn btn-primary",onClick:function(a){a.preventDefault();return c.setState({queryString:$("#searchbyForm").serialize()})}},"View")))),a("div",{className:"row"},
a(r,{wsUrl:"/api/students?"+this.state.queryString,auxiliary:f,customButtons:b,customFilter:function(a){return c.state.hideWithoutWitness?_.filter(a,function(a){return a.witnesser}):a}})))}},{render:function(){return!1}},_.invert({AdminStudentsR:"displayName"}))),s=function(a,c){return _.find(a.data,function(a){return c===a.id})||"??"},N=f(_.defaults({propTypes:{sub:d.object.isRequired,ccaInfo:d.object.isRequired,onLockClick:d.func.isRequired,onUnlockClick:d.func.isRequired},render:function(){var b=
this,c=a("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},"OK");return a(t,{canClose:!0,title:"Student-Submitted Information",buttons:c},a("table",{className:"table"},a("tbody",{},a("tr",{},a("th",{},"Email"),a("td",{},this.props.sub.email)),a("tr",{},a("th",{},"Phone Number"),a("td",{},this.props.sub.phone)),a("tr",{},a("th",{},"Date of Submission"),a("td",{},this.props.sub.date)),a("tr",{},a("th",{},"CCAs"),a("td",{},g(this.props.sub.cca,function(a){return s(b.props.ccaInfo,
a).name}).join(", ")||"None")),a("tr",{},a("th",{},"Delete Submission"),a("td",{},a("div",{className:"btn-toolbar",role:"toolbar"},a("button",{type:"button",className:"btn btn-default",onClick:function(){b.props.onUnlockClick();return u()}},"Delete and Unlock"),a("button",{type:"button",className:"btn btn-default",onClick:function(){b.props.onLockClick();return u()}},"Delete and Lock")))))))}},{render:function(){return!1}},_.invert({SubmissionCompleteModal:"displayName"}))),k={"/admin":{pageName:"Home",
onlyAdmin:!1,component:I,dataSpec:null},"/admin/ccas":{pageName:"Manage CCAs",onlyAdmin:!0,component:J,dataSpec:{humanName:"CCA",humanNamePlural:"CCAs",machineName:"ccas",editor:C,categoryColumn:["category",_.identity,"CCA Category"],columns:[["name",_.identity,"CCA Name"]]}},"/admin/subjects":{pageName:"Manage Subjects",onlyAdmin:!0,component:K,dataSpec:{humanName:"Subject",humanNamePlural:"Subjects",machineName:"subjects",editor:D,categoryColumn:["level",function(a){return g(a,function(a){return"Year "+
a}).join(", ")},"Applies To"],columns:[["name",_.identity,"Subject Name"],["code",function(b){return b?a("code",{},b):a("i",{},"(None; Compulsory Subject)")},"Subject Code"],["is_science",function(a){return a?"Yes":"No"},"Science Subject?"]]}},"/admin/teachers":{pageName:"Manage Teachers",onlyAdmin:!0,component:L,dataSpec:{humanName:"Teacher",humanNamePlural:"Teachers",machineName:"teachers",editor:G,categoryColumn:null,columns:[["name",_.identity,"Name"],["unit",_.identity,"Unit"],["email",_.identity,
"Email Address"],["is_admin",function(a){return a?"Yes":"No"},"Administrator?"],["witness_name",_.identity,"Witness Name"]]}},"/admin/students":{pageName:"Manage Students",onlyAdmin:!1,component:M,dataSpec:{humanName:"Student",humanNamePlural:"Students",machineName:"students",editor:H,categoryColumn:["class",_.identity,"Class"],columns:[["index_number",_.identity,"Index #"],["name",_.identity,"Name"],["chinese_name",_.identity,"Chinese"],["nric",function(a){return a.slice(-5)},"ID"],["subject_combi",
function(b){var c=this,d=g(b,function(a){return s(c.subjectInfo,a).code}).join(", ");b=g(b,function(a){return s(c.subjectInfo,a).name}).join(", ");return d?a("span",{title:b},d):"\u2014"},"Subject(s)"],["witnesser",function(b){return null===b?a("i",{},"None"):s(this.teacherInfo,b).name},"Witness"],["submission",function(a){return a.email||"\u2014"},"Email"],["submission",function(a){return a.phone||"\u2014"},"Phone"],["submission",function(b){return b.final_declaration_filename?a("a",{className:"btn btn-default btn-xs",
target:"_blank",href:"https://rvhs-sci-lab-undertaking.appspot.com/storage?filename="+encodeURIComponent(b.final_declaration_filename)},a("span",{className:"glyphicon glyphicon-floppy-save","aria-hidden":"true"})):"SubmissionCompleted"===b.tag?a("img",{src:"/static/res/loading.gif",width:16,height:16,style:{margin:"0 4px"}}):void 0},"PDF"],["submission",function(b,c){var d=this,f=a("span",{className:"glyphicon glyphicon-lock","aria-hidden":"true"}),g=a("span",{className:"glyphicon glyphicon-ok","aria-hidden":"true"}),
k=function(){return $.ajax("/api/students/"+c.id+"/unlock",{type:"POST"})},l=function(){return $.ajax("/api/students/"+c.id+"/lock",{type:"POST"})},n=function(){return React.render(a(N,{ccaInfo:d.ccaInfo,sub:b,onLockClick:l,onUnlockClick:k}),m())};return a("div",{className:"btn-group",role:"toolbar","aria-label":"Status Buttons"},"SubmissionNotOpen"===b.tag?a("button",{type:"button",className:"btn btn-danger btn-xs",onClick:k,title:"Click to unlock submission."},f,a("span",{className:"presentation-text",
"data-text":" Locked"})):"SubmissionOpen"===b.tag?a("button",{type:"button",className:"btn btn-primary btn-xs",onClick:l,title:"Click to lock submission."},f,a("span",{className:"presentation-text","data-text":" Unlocked"})):"SubmissionCompleted"===b.tag?a("button",{type:"button",className:"btn btn-success btn-xs",onClick:n,title:"Click to view submitted information."},g,a("span",{className:"presentation-text","data-text":" Completed"})):void 0)},function(b){var c=a("span",{className:"glyphicon glyphicon-lock",
"aria-hidden":"true"});a("span",{className:"glyphicon glyphicon-ok","aria-hidden":"true"});return a("span",{},a("button",{type:"button",className:"btn btn-primary btn-xs",onClick:function(){var a=g(b,"id").join(",");return $.ajax("/api/students/many/unlock",{type:"POST",data:{ids:a}})},title:"Click to unlock submission for all."},c,a("span",{className:"presentation-text","data-text":" Unlock These"}))," ",a("button",{type:"button",className:"btn btn-danger btn-xs",onClick:function(){var a=g(b,"id").join(",");
return $.ajax("/api/students/many/lock",{type:"POST",data:{ids:a}})},title:"Click to lock submission for all."},c,a("span",{className:"presentation-text","data-text":" Lock These"})))}]]}}},f=f(_.defaults({render:function(){var b=window.location.pathname,c=g(k,function(c,d){var f=a("li",{key:d,role:"presentation",className:d===b?"active":""},a("a",{href:d===b?"#":d},c.pageName));return c.onlyAdmin?"PrivAdmin"===l?f:null:f});return a("div",{id:"content-wrapper"},a("div",{id:"popover-wrapper"}),a("div",
{id:"modal-wrapper"}),a("div",{className:"container"},a("div",{className:"page-header"},a("h1",{},a("img",{src:"/static/res/rv.png",style:{height:"1em",position:"relative",top:"-0.2em",margin:"0 0.3em 0 0"}}),"RVHS Science Lab Undertaking \u2014 For Teachers")),a("p",{},"You are logged in as "+x+". ","PrivAdmin"===l?"You are an administrator. ":null,a("a",{href:"/auth/logout"},"Click here to logout. ")),a("div",{role:"tabpanel"},a("ul",{className:"nav nav-tabs"},c)),a("div",{id:"main-content"})))},
componentDidMount:function(){var b=window.location.pathname;return"undefined"===typeof window.WebSocket?React.render(a(t,{canClose:!1,title:"Browser Unsupported"},a("p",{},"Your browser is too old to use this website. This website requires at least Internet Explorer version 10, Apple Safari version 7, Google Chrome version 16, or Mozilla Firefox version 11. Regardless of which broswer you are using, it is always recommended that you use the latest version available.")),m()):React.render(a(k[b].component,
{}),$("#main-content").get(0))}},{render:function(){return!1}},_.invert({Page:"displayName"})));return React.render(a(f,{}),document.body)});
